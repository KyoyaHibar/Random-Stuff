"use strict";(()=>{var Be=Object.defineProperty;var P=(e,t)=>{for(var o in t)Be(e,o,{get:t[o],enumerable:!0})};var j={};P(j,{after:()=>b,before:()=>ke,instead:()=>_e,unpatchAll:()=>ye});var C=["a","b","i"],h=new Map;function ge(e,t,o,r,n){let i=h.get(t)?.[e];if(!i)return n?Reflect.construct(t[e],o,r):t[e].apply(r,o);for(let c of i.b.values()){let f=c.call(r,o);Array.isArray(f)&&(o=f)}let l=(...c)=>n?Reflect.construct(i.o,c,r):i.o.apply(r,c);for(let c of i.i.values()){let f=l;l=(...A)=>c.call(r,A,f)}let s=l(...o);for(let c of i.a.values())s=c.call(r,o,s)??s;return s}function U(e,t,o,r){let n=h.get(e),i=n?.[t];return i?.[r].has(o)?(i[r].delete(o),C.every(l=>i[l].size===0)&&(Reflect.defineProperty(e,t,{value:i.o,writable:!0,configurable:!0})||(e[t]=i.o),delete n[t]),Object.keys(n).length==0&&h.delete(e),!0):!1}function ye(){for(let[e,t]of h.entries())for(let o in t)for(let r of C)for(let n of t[o]?.[r].keys()??[])U(e,o,n,r)}var N=e=>(t,o,r,n=!1)=>{if(typeof o[t]!="function")throw new Error(`${t} is not a function in ${o.constructor.name}`);h.has(o)||h.set(o,{});let i=h.get(o);if(!i[t]){let c=o[t];i[t]={o:c,b:new Map,i:new Map,a:new Map};let f=(g,I,F)=>{let De=ge(t,o,I,g,F);return n&&s(),De},A=new Proxy(c,{apply:(g,I,F)=>f(I,F,!1),construct:(g,I)=>f(c,I,!0),get:(g,I,F)=>I=="toString"?c.toString.bind(c):Reflect.get(g,I,F)});Reflect.defineProperty(o,t,{value:A,configurable:!0,writable:!0})||(o[t]=A)}let l=Symbol(),s=()=>U(o,t,l,e);return i[t][e].set(l,r),s};var ke=N("b"),_e=N("i"),b=N("a");var he={...j};var z={};P(z,{filterModules:()=>G,find:()=>D,findAll:()=>W,findByDisplayName:()=>O,findByDisplayNameAll:()=>Ne,findByProps:()=>p,findByPropsAll:()=>Me,modules:()=>H});function be(e){Object.defineProperty(window.modules,e,{value:window.modules[e],enumerable:!1,configurable:!0,writable:!0})}for(let e in window.modules){let t=Number(e),o=window.modules[t].publicModule.exports;if(!o||o===window||o.proxygone===null){be(t);continue}}window.React=Object.values(window.modules).find(e=>e.publicModule.exports.createElement).publicModule.exports;var $=Object.values(window.modules).find(e=>e.publicModule.exports.isMoment).publicModule.exports,G=(e,t=!1)=>o=>{let r=[],n=$?.locale();for(let i in e){let l=Number(i),s=e[l].publicModule.exports;if(!e[l].isInitialized)try{__r(l),n&&n!==$.locale()&&$.locale(n)}catch{}if(!s){be(l);continue}try{if(s.default&&s.__esModule&&o(s.default)){if(t)return s.default;r.push(s.default)}if(o(s)){if(t)return s;r.push(s)}}catch(c){console.error(`Failed to getModule... ${c.stack||c.toString()}`)}}if(!t)return r},H=window.modules,D=G(H,!0),W=G(H),we=e=>t=>e.every(o=>t[o]!==void 0),xe=(e,t)=>t?o=>o.name===e:o=>o?.default?.name===e,p=(...e)=>D(we(e)),Me=(...e)=>W(we(e)),O=(e,t=!0)=>D(xe(e,t)),Ne=(e,t=!0)=>W(xe(e,t));var Oe=p("setLogFn").default,Ve=new Oe("Vendetta"),B=Ve;var Ee=p("setString","getString");function T(e){try{Ee.setString(e)}catch{throw new Error("Failed to set clipboard content.")}}function k(e,t,{walkable:o=[],ignore:r=[],maxDepth:n=100}={}){let i=0;function l(s,c,{walkable:f=[],ignore:A=[]}={}){if(i+=1,!(i>n)){if(typeof c=="string"){if(s.hasOwnProperty(c))return s[c]}else if(c(s))return s;if(!!s){if(Array.isArray(s))for(let v of s){let g=l(v,c,{walkable:f,ignore:A});if(g)return g}else if(typeof s=="object"){for(let v of Object.keys(s))if(!(f!=null&&f.includes(v))&&!A.includes(v))try{let g=l(s[v],c,{walkable:f,ignore:A});if(g)return g}catch{}}}}}return l(e,t,{walkable:o,ignore:r})}function _(e,t){return k(e,t,{walkable:["props","children","child","sibling"]})}var J={};P(J,{DISCORD_SERVER:()=>K,GITHUB:()=>Y});var K="https://discord.gg/n9QQ4XhhJP",Y="https://github.com/vendetta-mod";var X={};P(X,{AsyncStorage:()=>je,React:()=>Ue,ReactNative:()=>m,channels:()=>Ce,constants:()=>Le,i18n:()=>V,stylesheet:()=>w,toasts:()=>Q,url:()=>E});var Le=p("API_HOST"),Ce=p("getVoiceChannelId"),V=p("Messages"),E=p("openURL"),Q=D(e=>e.open&&e.close&&!e.startDrag&&!e.init&&!e.openReplay&&!e.setAlwaysOnTop),w=p("createThemedStyleSheet"),Ue=p("createElement"),m=p("Text","Image"),je=p("setItem");var q={};P(q,{Forms:()=>d});var d=p("FormSection");var Z={};P(Z,{showToast:()=>y});function y(e,t){return Q.open({content:e,source:t})}var ee=p("registerAsset"),x={};function te(){try{b("registerAsset",ee,(e,t)=>{let o=e[0];x[o.name]={...o,id:t}});for(let e=1;;e++){let t=ee.getAssetByID(e);if(!t)break;x[t.name]||(x[t.name]={...t,id:e})}}catch{}}var Se=e=>Object.values(x).find(e),Re=e=>x[e],Ae=e=>ee.getAssetByID(e),a=e=>x[e]?.id;var{FormRow:S,FormSection:$e}=d;function oe({navigation:e}){return React.createElement($e,{key:"Vendetta",title:"Vendetta"},React.createElement(S,{label:"General",leading:()=>React.createElement(S.Icon,{source:a("settings")}),trailing:S.Arrow,onPress:()=>e.push("VendettaSettings")}),React.createElement(S,{label:"Plugins",leading:()=>React.createElement(S.Icon,{source:a("debug")}),trailing:S.Arrow,onPress:()=>e.push("VendettaPlugins")}),React.createElement(S,{label:"Asset Browser",leading:()=>React.createElement(S.Icon,{source:a("grid")}),trailing:S.Arrow,onPress:()=>e.push("VendettaAssetBrowser")}))}var R,Ge=eval;function L(e){if(R!==void 0&&R.readyState!==WebSocket.CLOSED&&R.close(),e===""){y("Invalid debugger URL!",a("Small"));return}R=new WebSocket(`ws://${e}`),R.addEventListener("open",()=>y("Connected to debugger.",a("Check"))),R.addEventListener("message",t=>{try{Ge(t.data)}catch(o){console.error(o)}}),R.addEventListener("error",t=>{console.log(`Debugger error: ${t.message}`),y("An error occurred with the debugger connection!",a("Small"))})}function Ie(){b("nativeLoggingHook",globalThis,(e,t)=>{R?.readyState===WebSocket.OPEN&&R.send(JSON.stringify({message:e[0],level:e[1]})),B.log(e[0])})}var{FormRow:Te,FormText:He}=d;function re({label:e,version:t,icon:o}){return React.createElement(Te,{label:e,leading:()=>React.createElement(Te.Icon,{source:a(o)}),trailing:()=>React.createElement(He,null,t),onPress:()=>{T(`${e} - ${t}`),y("Copied version to clipboard.",a("toast_copy_link"))}})}var{FormRow:u,FormSection:ne,FormInput:We}=d,se=window.HermesInternal.getRuntimeProperties(),ie=m.Platform.constants.reactNativeVersion;function ae(){let[e,t]=React.useState(""),o=[{label:"Discord",version:m.NativeModules.InfoDictionaryManager.Version,icon:"Discord"},{label:"React",version:React.version,icon:"ic_category_16px"},{label:"React Native",version:`${ie.major||0}.${ie.minor||0}.${ie.patch||0}`,icon:"mobile"},{label:"Hermes",version:`${se["OSS Release Version"]} ${se.Build} | Bytecode ${se["Bytecode Version"]}`,icon:"ic_hammer_and_chisel_24px"}];return React.createElement(m.ScrollView,null,React.createElement(ne,{title:"Links",android_noDivider:!0},React.createElement(u,{label:"Discord Server",leading:()=>React.createElement(u.Icon,{source:a("Discord")}),trailing:u.Arrow,onPress:()=>E.openURL(K)}),React.createElement(u,{label:"GitHub",leading:()=>React.createElement(u.Icon,{source:a("img_account_sync_github_white")}),trailing:u.Arrow,onPress:()=>E.openURL(Y)})),React.createElement(ne,{title:"Debug"},React.createElement(We,{value:e,onChange:r=>t(r),title:"DEBUGGER URL"}),React.createElement(u,{label:"Connect to debug websocket",leading:()=>React.createElement(u.Icon,{source:a("copy")}),trailing:u.Arrow,onPress:()=>L(e)}),React.createElement(u,{label:"Reload Discord",leading:()=>React.createElement(u.Icon,{source:a("ic_message_retry")}),trailing:u.Arrow,onPress:()=>m.NativeModules.BundleUpdaterManager.reload()})),React.createElement(ne,{title:"Versions"},o.map(r=>React.createElement(re,{label:r.label,version:r.version,icon:r.icon}))))}var M={};async function ve(e){if(e.endsWith("/")||(e+="/"),M[e])throw new Error("That plugin is already installed!");let t;try{t=await(await fetch(new URL("manifest.json",e),{cache:"no-store"})).json()}catch{throw new Error(`Failed to fetch manifest for ${e}`)}M[e]={id:e.split("://")[1],manifest:t,enabled:!0,js:""}}var{FormRow:ce,FormText:qt,FormSwitch:ze}=d,Pe=w.createThemedStyleSheet({card:{backgroundColor:w.ThemeColorMap.BACKGROUND_SECONDARY,borderRadius:5,margin:10},header:{backgroundColor:w.ThemeColorMap.BACKGROUND_TERTIARY,borderTopLeftRadius:5,borderTopRightRadius:5}});function le({plugin:e}){let[t,o]=React.useState(e.enabled);return React.createElement(m.View,{style:Pe.card},React.createElement(ce,{style:Pe.header,label:`${e.manifest.name} by ${e.manifest.author}`,leading:React.createElement(ce.Icon,{source:a(e.manifest.icon||"ic_application_command_24px")}),trailing:React.createElement(ze,{value:e.enabled,onValueChange:r=>{o(r),e.enabled=t}})}),React.createElement(ce,{label:e.manifest.description}))}var{FormInput:Ke,FormRow:pe,FormText:Ye}=d,Fe=w.createThemedStyleSheet({disclaimer:{backgroundColor:w.ThemeColorMap.BACKGROUND_SECONDARY,padding:10},disclaimerText:{textAlign:"center"}});function me(){let[e,t]=React.useState(""),[o,r]=React.useState(M);return React.createElement(React.Fragment,null,React.createElement(Ke,{value:e,onChange:n=>t(n),title:"PLUGIN URL"}),React.createElement(pe,{label:"Install plugin",leading:()=>React.createElement(pe.Icon,{source:a("add_white")}),trailing:pe.Arrow,onPress:()=>{ve(e).then(()=>{t(""),r(M)}).catch(n=>{y(n.message,a("Small"))})}}),React.createElement(m.FlatList,{data:Object.values(o),renderItem:({item:n})=>React.createElement(le,{plugin:n}),keyExtractor:n=>n.id}),React.createElement(m.View,{style:Fe.disclaimer},React.createElement(Ye,{style:Fe.disclaimerText},"Plugins are currently non-functional, but most of the infrastructure and UI is in place.")))}var{FormRow:Je}=d,Qe=w.createThemedStyleSheet({asset:{width:32,height:32}});function de({asset:e}){return React.createElement(Je,{label:`${e.name} - ${e.id}`,trailing:()=>React.createElement(m.Image,{source:e.id,style:Qe.asset}),onPress:()=>{T(e.name),y("Copied asset name to clipboard.",a("toast_copy_link"))}})}var{FormInput:Xe}=d;function fe(){let[e,t]=React.useState("");return React.createElement(React.Fragment,null,React.createElement(Xe,{value:e,onChange:o=>t(o),title:"SEARCH"}),React.createElement(m.FlatList,{data:Object.values(x).filter(o=>o.name.includes(e)),renderItem:({item:o})=>React.createElement(de,{asset:o}),keyExtractor:o=>o.name}))}var qe=O("getScreens",!1),Ze=O("UserSettingsOverviewWrapper",!1);function ue(){b("default",qe,(e,t)=>({...t,VendettaSettings:{title:"Vendetta",render:ae},VendettaPlugins:{title:"Plugins",render:me},VendettaAssetBrowser:{title:"Asset Browser",render:fe}})),b("default",Ze,(e,t)=>{let o=_(t.props.children,r=>r.type&&r.type.name==="UserSettingsOverview");b("renderSupportAndAcknowledgements",o.type.prototype,(r,{props:{children:n}})=>{let i=n.findIndex(l=>l?.type?.name==="UploadLogsButton");i!==-1&&n.splice(i,1)}),b("render",o.type.prototype,(r,{props:{children:n}})=>{let i=[V.Messages.BILLING_SETTINGS,V.Messages.PREMIUM_SETTINGS],l=n.findIndex(s=>i.includes(s.props.title));n.splice(l===-1?4:l,0,React.createElement(oe,{navigation:o.props.navigation}))})},!0)}console.log("Hello from Vendetta!");async function et(){let e=!1;try{window.vendetta={patcher:he,metro:{...z,common:{...X}},constants:{...J},utils:{copyText:T,findInReactTree:_,findInTree:k},debug:{connectToDebugger:L},ui:{components:{...q},toasts:{...Z},assets:{all:x,find:Se,getAssetByID:Ae,getAssetByName:Re,getAssetIDByName:a}},logger:B},ue(),te(),Ie()}catch(t){e=!0,alert(`Vendetta failed to initialize...
${t.stack||t.toString()}`)}e||B.log("Vendetta is ready!")}et();})();
//# sourceURL=Vendetta