"use strict";(()=>{var ft=Object.defineProperty;var O=(e,t)=>{for(var o in t)ft(e,o,{get:t[o],enumerable:!0})};var de={};O(de,{after:()=>x,before:()=>ut,instead:()=>gt,unpatchAll:()=>Ke});var ce=["a","b","i"],S=new Map;function He(e,t,o,n,r){let i=S.get(t)?.[e];if(!i)return r?Reflect.construct(t[e],o,n):t[e].apply(n,o);for(let d of i.b.values()){let b=d.call(n,o);Array.isArray(b)&&(o=b)}let a=(...d)=>r?Reflect.construct(i.o,d,n):i.o.apply(n,d);for(let d of i.i.values()){let b=a;a=(...D)=>d.call(n,D,b)}let c=a(...o);for(let d of i.a.values())c=d.call(n,o,c)??c;return c}function le(e,t,o,n){let r=S.get(e),i=r?.[t];return i?.[n].has(o)?(i[n].delete(o),ce.every(a=>i[a].size===0)&&(Reflect.defineProperty(e,t,{value:i.o,writable:!0,configurable:!0})||(e[t]=i.o),delete r[t]),Object.keys(r).length==0&&S.delete(e),!0):!1}function Ke(){for(let[e,t]of S.entries())for(let o in t)for(let n of ce)for(let r of t[o]?.[n].keys()??[])le(e,o,r,n)}var W=e=>(t,o,n,r=!1)=>{if(typeof o[t]!="function")throw new Error(`${t} is not a function in ${o.constructor.name}`);S.has(o)||S.set(o,{});let i=S.get(o);if(!i[t]){let d=o[t];i[t]={o:d,b:new Map,i:new Map,a:new Map};let b=(v,A,U)=>{let mt=He(t,o,A,v,U);return r&&c(),mt},D=new Proxy(d,{apply:(v,A,U)=>b(A,U,!1),construct:(v,A)=>b(d,A,!0),get:(v,A,U)=>A=="toString"?d.toString.bind(d):Reflect.get(v,A,U)});Reflect.defineProperty(o,t,{value:D,configurable:!0,writable:!0})||(o[t]=D)}let a=Symbol(),c=()=>le(o,t,a,e);return i[t][e].set(a,n),c};var ut=W("b"),gt=W("i"),x=W("a");var Je={...de};var ge={};O(ge,{filterModules:()=>me,find:()=>k,findAll:()=>ue,findByDisplayName:()=>B,findByDisplayNameAll:()=>yt,findByProps:()=>p,findByPropsAll:()=>ht,findByStoreName:()=>X,modules:()=>fe});var pe=e=>Object.values(window.modules).find(t=>t.publicModule.exports?.[e]).publicModule.exports;window.React=pe("createElement");var l=pe("Text"),z=pe("isMoment");function Ye(e){Object.defineProperty(window.modules,e,{value:window.modules[e],enumerable:!1,configurable:!0,writable:!0})}for(let e in window.modules){let t=Number(e),o=window.modules[t].publicModule.exports;if(!o||o===window||o.proxygone===null){Ye(t);continue}}var me=(e,t=!1)=>o=>{let n=[],r=z?.locale();for(let i in e){let a=Number(i),c=e[a].publicModule.exports;if(!e[a].isInitialized)try{__r(a),r&&r!==z.locale()&&z.locale(r)}catch{}if(!c){Ye(a);continue}try{if(c.default&&c.__esModule&&o(c.default)){if(t)return c.default;n.push(c.default)}if(o(c)){if(t)return c;n.push(c)}}catch(d){console.error(`Failed to getModule... ${d.stack||d.toString()}`)}}if(!t)return n},fe=window.modules,k=me(fe,!0),ue=me(fe),We=e=>t=>e.every(o=>t[o]!==void 0),ze=(e,t)=>t?o=>o.name===e:o=>o?.default?.name===e,p=(...e)=>k(We(e)),ht=(...e)=>ue(We(e)),B=(e,t=!0)=>k(ze(e,t)),yt=(e,t=!0)=>ue(ze(e,t)),X=e=>k(t=>t.getName?.()===e);var bt=p("setLogFn").default,vt=new bt("Vendetta"),h=vt;var Te={};O(Te,{Flux:()=>xt,FluxDispatcher:()=>q,NavigationNative:()=>we,React:()=>wt,ReactNative:()=>l,assets:()=>$,channels:()=>St,clipboard:()=>ve,constants:()=>he,i18n:()=>Q,invites:()=>Se,navigation:()=>N,navigationStack:()=>xe,stylesheet:()=>m,toasts:()=>be,url:()=>ye});var he=p("API_HOST"),St=p("getVoiceChannelId"),Q=p("Messages"),ye=p("openURL"),be=k(e=>e.open&&e.close&&!e.startDrag&&!e.init&&!e.openReplay&&!e.setAlwaysOnTop),m=p("createThemedStyleSheet"),ve=p("setString","getString","hasString"),$=p("registerAsset"),Se=p("acceptInviteAndTransitionToInviteChannel"),N=p("pushLazy"),xe=p("createStackNavigator"),we=p("NavigationContainer"),xt=p("connectStores"),q=p("_currentDispatchActionType"),wt=window.React;function R(e){try{ve.setString(e)}catch{throw new Error("Failed to set clipboard content.")}}function j(e,t,{walkable:o=[],ignore:n=[],maxDepth:r=100}={}){let i=0;function a(c,d,{walkable:b=[],ignore:D=[]}={}){if(i+=1,!(i>r)){if(typeof d=="string"){if(c.hasOwnProperty(d))return c[d]}else if(d(c))return c;if(c){if(Array.isArray(c))for(let E of c){let v=a(E,d,{walkable:b,ignore:D});if(v)return v}else if(typeof c=="object"){for(let E of Object.keys(c))if(!(b!=null&&b.includes(E))&&!D.includes(E))try{let v=a(c[E],d,{walkable:b,ignore:D});if(v)return v}catch{}}}}}return a(e,t,{walkable:o,ignore:n})}var Z=(e,t)=>j(e,t,{walkable:["props","children","child","sibling"]});var Pe={};O(Pe,{DISCORD_SERVER:()=>Re,GITHUB:()=>Ie});var Re="n9QQ4XhhJP",Ie="https://github.com/vendetta-mod";var De={};O(De,{Forms:()=>f,General:()=>G,Search:()=>_e});var f=p("Form","FormSection"),G=p("Button","Text","View"),_e=B("StaticSearchBarContainer");var Ae={};O(Ae,{showToast:()=>u});function u(e,t){return be.open({content:e,source:t})}var w={};function Xe(){try{x("registerAsset",$,(e,t)=>{let o=e[0];w[o.name]={...o,id:t}});for(let e=1;;e++){let t=$.getAssetByID(e);if(!t)break;w[t.name]||(w[t.name]={...t,id:e})}}catch{}}var Qe=e=>Object.values(w).find(e),qe=e=>w[e],Ze=e=>$.getAssetByID(e),s=e=>w[e]?.id;var Ne=l.NativeModules.MMKVManager;function V(e,t){let o={},n={get(r,i){let a=Reflect.get(r,i);return typeof a=="object"&&a!==null?new Proxy(a,n):a},set(r,i,a){return Reflect.set(r,i,a),Ne.setItem(e,JSON.stringify(o)),!0},deleteProperty(r,i){return Reflect.deleteProperty(r,i),Ne.setItem(e,JSON.stringify(o)),!0}};return Ne.getItem(e).then(async function(r){if(!r)return;let i=JSON.parse(r);if(t&&typeof t=="function")t(i);else for(let a of Object.keys(i))o[a]=i[a]}),new Proxy(o,n)}var T=V("VENDETTA_SETTINGS");var{FormRow:I,FormSection:Tt,FormDivider:et}=f;function Me({navigation:e}){return React.createElement(Tt,{key:"Vendetta",title:"Vendetta"},React.createElement(I,{label:"General",leading:React.createElement(I.Icon,{source:s("settings")}),trailing:I.Arrow,onPress:()=>e.push("VendettaSettings")}),React.createElement(et,null),React.createElement(I,{label:"Plugins",leading:React.createElement(I.Icon,{source:s("debug")}),trailing:I.Arrow,onPress:()=>e.push("VendettaPlugins")}),T.developerSettings&&React.createElement(React.Fragment,null,React.createElement(et,null),React.createElement(I,{label:"Developer",leading:React.createElement(I.Icon,{source:s("ic_progress_wrench_24px")}),trailing:I.Arrow,onPress:()=>e.push("VendettaDeveloper")})))}var P;function ee(e){if(P!==void 0&&P.readyState!==WebSocket.CLOSED&&P.close(),e===""){u("Invalid debugger URL!",s("Small"));return}P=new WebSocket(`ws://${e}`),P.addEventListener("open",()=>u("Connected to debugger.",s("Check"))),P.addEventListener("message",t=>{try{(0,eval)(t.data)}catch(o){console.error(o)}}),P.addEventListener("error",t=>{console.log(`Debugger error: ${t.message}`),u("An error occurred with the debugger connection!",s("Small"))})}function tt(){x("nativeLoggingHook",globalThis,(e,t)=>{P?.readyState===WebSocket.OPEN&&P.send(JSON.stringify({message:e[0],level:e[1]})),h.log(e[0])})}var Fe="da83d47";function ot(){let e=l.NativeModules.InfoDictionaryManager,t=window.HermesInternal.getRuntimeProperties(),o=l.Platform.constants,n=o.reactNativeVersion,r=l.NativeModules.DCDDeviceManager;return{vendetta:{version:Fe},discord:{version:e.Version,build:e.Build},react:{version:React.version,nativeVersion:`${n.major||0}.${n.minor||0}.${n.patch||0}`},hermes:{version:t["OSS Release Version"],buildType:t.Build,bytecodeVersion:t["Bytecode Version"]},...l.Platform.select({android:{os:{name:"Android",version:o.Release,sdk:o.Version}},ios:{os:{name:o.systemName,version:o.osVersion}}}),...l.Platform.select({android:{device:{manufacturer:o.Manufacturer,brand:o.Brand,model:o.Model,codename:r.device}},ios:{device:{manufacturer:r.deviceManufacturer,brand:r.deviceBrand,model:r.deviceModel,codename:r.device}}})}}var{FormRow:rt,FormText:Rt}=f;function te({label:e,version:t,icon:o}){return React.createElement(rt,{label:e,leading:React.createElement(rt.Icon,{source:s(o)}),trailing:React.createElement(Rt,null,t),onPress:()=>{R(`${e} - ${t}`),u("Copied version to clipboard.",s("toast_copy_link"))}})}var{FormRow:_,FormSwitchRow:It,FormSection:oe,FormDivider:re}=f,g=ot();function Ce(){let[e,t]=React.useState(T.developerSettings||!1),o=[{label:"Vendetta",version:g.vendetta.version,icon:"ic_progress_wrench_24px"},{label:"Discord",version:`${g.discord.version} (${g.discord.build})`,icon:"Discord"},{label:"React",version:g.react.version,icon:"ic_category_16px"},{label:"React Native",version:g.react.nativeVersion,icon:"mobile"},{label:"Hermes",version:`${g.hermes.version} ${g.hermes.buildType} (Bytecode ${g.hermes.bytecodeVersion})`,icon:"ic_server_security_24px"}],n=[{label:"Operating System",version:`${g.os.name} ${g.os.version}`,icon:"ic_cog_24px"},...g.os.sdk?[{label:"SDK",version:g.os.sdk,icon:"ic_profile_badge_verified_developer_color"}]:[],{label:"Manufacturer",version:g.device.manufacturer,icon:"ic_hammer_and_chisel_24px"},{label:"Brand",version:g.device.brand,icon:"ic_settings_boost_24px"},{label:"Model",version:g.device.model,icon:"ic_phonelink_24px"},{label:l.Platform.select({android:"Codename",ios:"Machine ID"}),version:g.device.codename,icon:"ic_compose_24px"}];return React.createElement(l.ScrollView,null,React.createElement(oe,{title:"Links"},React.createElement(_,{label:"Discord Server",leading:React.createElement(_.Icon,{source:s("Discord")}),trailing:_.Arrow,onPress:()=>Se.acceptInviteAndTransitionToInviteChannel({inviteKey:Re})}),React.createElement(re,null),React.createElement(_,{label:"GitHub",leading:React.createElement(_.Icon,{source:s("img_account_sync_github_white")}),trailing:_.Arrow,onPress:()=>ye.openURL(Ie)})),React.createElement(oe,{title:"Versions"},o.map(r=>React.createElement(React.Fragment,null,React.createElement(te,{label:r.label,version:r.version,icon:r.icon}),React.createElement(re,null)))),React.createElement(oe,{title:"Platform Info"},n.map(r=>React.createElement(React.Fragment,null,React.createElement(te,{label:r.label,version:r.version,icon:r.icon}),React.createElement(re,null)))),React.createElement(oe,{title:"Actions"},React.createElement(_,{label:"Reload Discord",leading:React.createElement(_.Icon,{source:s("ic_message_retry")}),onPress:()=>l.NativeModules.BundleUpdaterManager.reload()}),React.createElement(re,null),React.createElement(It,{label:"Developer Settings",leading:React.createElement(_.Icon,{source:s("ic_progress_wrench_24px")}),value:e,onValueChange:r=>{T.developerSettings=r,t(r)}})))}var L=m.createThemedStyleSheet({container:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},card:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:m.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:m.ThemeColorMap.HEADER_PRIMARY},headerTitle:{fontFamily:he.Fonts.PRIMARY_BOLD,color:m.ThemeColorMap.HEADER_PRIMARY},backIcon:{tintColor:m.ThemeColorMap.INTERACTIVE_ACTIVE,marginLeft:15,marginRight:20}}),nt=xe.createStackNavigator(),{TouchableOpacity:Pt,Image:_t}=G;function H({name:e,children:t}){return React.createElement(we.NavigationContainer,{independent:!0},React.createElement(nt.Navigator,{initialRouteName:e,style:L.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:L.card,headerStyle:L.header,headerTitleContainerStyle:L.headerTitleContainer}},React.createElement(nt.Screen,{name:e,component:t,options:{headerTitleStyle:L.headerTitle,headerLeft:()=>React.createElement(Pt,{onPress:()=>N.pop()},React.createElement(_t,{style:L.backIcon,source:s("back-icon")}))}})))}var y=V("VENDETTA_PLUGINS",async function(e){for(let t of Object.keys(e)){let o=e[t];e[t].update?await K(o.id):y[t]=e[t],e[t].enabled&&y[t]&&Oe(t)}}),M={};async function K(e){if(e.endsWith("/")||(e+="/"),typeof e!="string"||e in y)throw new Error("Plugin ID invalid or taken");let t;try{t=await(await fetch(new URL("manifest.json",e),{cache:"no-store"})).json()}catch{throw new Error(`Failed to fetch manifest for ${e}`)}let o;try{o=await(await fetch(new URL(t.main||"index.js",e),{cache:"no-store"})).text()}catch{throw new Error(`Failed to fetch JS for ${e}`)}if(o.length===0)throw new Error(`Failed to fetch JS for ${e}`);y[e]={id:e,manifest:t,enabled:!1,update:!0,js:o}}function Ee(e){let t={...window.vendetta,plugin:{manifest:e.manifest,storage:V(e.id),showSettings:()=>ke(e)}},o=`vendetta=>{return ${e.js}}
//# sourceURL=${e.id}`,n=(0,eval)(o)(t),r=typeof n=="function"?n():n;return r.default||r}function Oe(e){let t=y[e];if(!t)throw new Error("Attempted to start non-existent plugin");try{let o=Ee(t);M[e]=o,o.onLoad?.(),t.enabled=!0}catch(o){h.error(`Plugin ${t.id} errored whilst loading, and will be unloaded`,o);try{M[t.id]?.onUnload?.()}catch(n){h.error(`Plugin ${t.id} errored whilst unloading`,n)}delete M[e],t.enabled=!1}}function J(e){let t=y[e],o=M[e];if(!t)throw new Error("Attempted to stop non-existent plugin");if(!o)throw new Error("Attempted to stop a non-started plugin");try{M[t.id]?.onUnload?.()}catch(n){h.error(`Plugin ${t.id} errored whilst unloading`,n)}delete M[e],t.enabled=!1}function ne(e){y[e].enabled&&J(e),delete y[e]}var Y=e=>M[e]?.settings;function ke(e){let t=Y(e.id);if(!t)return h.error(`Plugin ${e.id} is not loaded or has no settings`);N.push(H,{name:e.manifest.name,children:t})}var{FormRow:Be,FormSwitch:Dt}=f,{TouchableOpacity:ie,Image:se}=G,F=m.createThemedStyleSheet({card:{backgroundColor:m.ThemeColorMap.BACKGROUND_SECONDARY,borderRadius:5,margin:10,marginTop:0},header:{backgroundColor:m.ThemeColorMap.BACKGROUND_TERTIARY,borderTopLeftRadius:5,borderTopRightRadius:5},actions:{justifyContent:"flex-end",flexDirection:"row-reverse",alignItems:"center"},icon:{width:22,height:22,marginLeft:5,tintColor:m.ThemeColorMap.INTERACTIVE_NORMAL}});function Ve({plugin:e}){let[t,o]=React.useState(e.enabled),[n,r]=React.useState(e.update),[i,a]=React.useState(!1);return i?React.createElement(React.Fragment,null):React.createElement(l.View,{style:F.card},React.createElement(Be,{style:F.header,label:`${e.manifest.name} by ${e.manifest.authors.map(c=>c.name).join(", ")}`,leading:React.createElement(Be.Icon,{source:s(e.manifest.vendetta?.icon||"ic_application_command_24px")}),trailing:React.createElement(Dt,{value:e.enabled,onValueChange:c=>{c?Oe(e.id):J(e.id),o(c)}})}),React.createElement(Be,{label:e.manifest.description,trailing:React.createElement(l.View,{style:F.actions},React.createElement(ie,{onPress:()=>{ne(e.id),a(!0)}},React.createElement(se,{style:F.icon,source:s("ic_message_delete")})),React.createElement(ie,{onPress:()=>{R(e.id),u("Copied plugin URL to clipboard.",s("toast_copy_link"))}},React.createElement(se,{style:F.icon,source:s("copy")})),React.createElement(ie,{onPress:()=>{e.update=!e.update,u(`${e.update?"Enabled":"Disabled"} updates for ${e.manifest.name}.`,s("toast_image_saved")),r(e.update)}},React.createElement(se,{style:F.icon,source:s(e.update?"Check":"Small")})),Y(e.id)&&React.createElement(ie,{onPress:()=>ke(e)},React.createElement(se,{style:F.icon,source:s("settings")})))}))}var{FormInput:At,FormRow:it}=f;function Le(){let[e,t]=React.useState(""),[o,n]=React.useState(y);return React.createElement(l.View,{style:{flex:1}},React.createElement(At,{value:e,onChange:r=>t(r),title:"PLUGIN URL"}),React.createElement(it,{label:"Install plugin",leading:React.createElement(it.Icon,{source:s("ic_add_perk_24px")}),onPress:()=>{K(e).then(()=>{t(""),n(y)}).catch(r=>{u(r.message,s("Small"))})}}),React.createElement(l.FlatList,{style:{marginTop:10},data:Object.values(o),renderItem:({item:r})=>React.createElement(Ve,{plugin:r}),keyExtractor:r=>r.id}))}var{FormRow:Nt}=f,Mt=m.createThemedStyleSheet({asset:{width:32,height:32}});function Ue({asset:e}){return React.createElement(Nt,{label:`${e.name} - ${e.id}`,trailing:React.createElement(l.Image,{source:e.id,style:Mt.asset}),onPress:()=>{R(e.name),u("Copied asset name to clipboard.",s("toast_copy_link"))}})}var{FormDivider:Ft}=f,Ct=m.createThemedStyleSheet({search:{margin:0,padding:15,borderBottomWidth:0,background:"none",backgroundColor:"none"}});function $e(){let[e,t]=React.useState("");return React.createElement(l.View,{style:{flex:1}},React.createElement(_e,{style:Ct.search,onChangeText:o=>t(o),placeholder:"Search..."}),React.createElement(l.FlatList,{data:Object.values(w).filter(o=>o.name.includes(e)),renderItem:({item:o})=>React.createElement(React.Fragment,null,React.createElement(Ue,{asset:o}),React.createElement(Ft,null)),keyExtractor:o=>o.name}))}var{FormSection:st,FormRow:C,FormInput:Et,FormDivider:at}=f;function je(){let[e,t]=React.useState(T.debuggerUrl||"");return React.createElement(l.View,{style:{flex:1}},React.createElement(st,{title:"Debug"},React.createElement(Et,{value:e,onChange:o=>{T.debuggerUrl=o,t(o)},title:"DEBUGGER URL"}),React.createElement(at,null),React.createElement(C,{label:"Connect to debug websocket",leading:()=>React.createElement(C.Icon,{source:s("copy")}),onPress:()=>ee(e)}),React.createElement(at,null),window.__vendetta_rdc&&React.createElement(C,{label:"Connect to React DevTools",leading:()=>React.createElement(C.Icon,{source:s("ic_badge_staff")}),onPress:()=>{try{window.__vendetta_rdc?.connectToDevTools({host:e.split(":")[0],resolveRNStyle:l.StyleSheet.flatten})}catch(o){h.error("Failed to connect to React DevTools!",o),u("Failed to connect to React DevTools!",s("Small"))}}})),React.createElement(st,{title:"Other"},React.createElement(C,{label:"Asset Browser",leading:()=>React.createElement(C.Icon,{source:s("ic_media_upload")}),trailing:C.Arrow,onPress:()=>N.push(H,{name:"Asset Browser",children:$e})})))}var Ot=B("getScreens",!1),kt=B("UserSettingsOverviewWrapper",!1),ae=[];function Ge(){x("default",Ot,(e,t)=>({...t,VendettaSettings:{title:"Vendetta",render:Ce},VendettaPlugins:{title:"Plugins",render:Le},VendettaDeveloper:{title:"Developer",render:je}})),x("default",kt,(e,t)=>{for(let n of ae)n();ae=[];let o=Z(t.props.children,n=>n.type&&n.type.name==="UserSettingsOverview");ae.push(x("renderSupportAndAcknowledgements",o.type.prototype,(n,{props:{children:r}})=>{let i=r.findIndex(a=>a?.type?.name==="UploadLogsButton");i!==-1&&r.splice(i,1)})),ae.push(x("render",o.type.prototype,(n,{props:{children:r}})=>{let i=[Q.Messages.BILLING_SETTINGS,Q.Messages.PREMIUM_SETTINGS],a=r.findIndex(c=>i.includes(c.props.title));r.splice(a===-1?4:a,0,React.createElement(Me,{navigation:o.props.navigation}))}))})}var Bt=p("updateTheme","overrideTheme"),ct=p("setAMOLEDThemeEnabled"),lt=X("ThemeStore"),Vt=X("UnsyncedUserSettingsStore");function dt(){let e=lt.theme||"dark";Bt.overrideTheme(e),ct&&Vt.useAMOLEDTheme===2&&ct.setAMOLEDThemeEnabled(!0),q.unsubscribe("I18N_LOAD_START",dt)}function pt(){try{lt&&q.subscribe("I18N_LOAD_START",dt)}catch(e){h.error("Failed to fix theme...",e)}}console.log("Hello from Vendetta!");async function Lt(){let e=!1;try{window.vendetta={patcher:Je,metro:{...ge,common:{...Te}},constants:{...Pe},utils:{copyText:R,findInReactTree:Z,findInTree:j},debug:{connectToDebugger:ee},ui:{components:{...De},toasts:{...Ae},assets:{all:w,find:Qe,getAssetByID:Ze,getAssetByName:qe,getAssetIDByName:s}},plugins:{plugins:y,fetchPlugin:K,evalPlugin:Ee,stopPlugin:J,removePlugin:ne,getSettings:Y},settings:T,logger:h,version:Fe},tt(),Xe(),pt(),Ge()}catch(t){e=!0,alert(`Vendetta failed to initialize... ${t.stack||t.toString()}`)}e||h.log("Vendetta is ready!")}Lt();})();
//# sourceURL=Vendetta