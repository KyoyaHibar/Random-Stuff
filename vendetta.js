"use strict";(()=>{var mt=Object.defineProperty;var C=(e,t)=>{for(var o in t)mt(e,o,{get:t[o],enumerable:!0})};var pe={};C(pe,{after:()=>x,before:()=>ft,instead:()=>ut,unpatchAll:()=>Ge});var le=["a","b","i"],S=new Map;function je(e,t,o,n,r){let i=S.get(t)?.[e];if(!i)return r?Reflect.construct(t[e],o,n):t[e].apply(n,o);for(let p of i.b.values()){let b=p.call(n,o);Array.isArray(b)&&(o=b)}let a=(...p)=>r?Reflect.construct(i.o,p,n):i.o.apply(n,p);for(let p of i.i.values()){let b=a;a=(...D)=>p.call(n,D,b)}let c=a(...o);for(let p of i.a.values())c=p.call(n,o,c)??c;return c}function de(e,t,o,n){let r=S.get(e),i=r?.[t];return i?.[n].has(o)?(i[n].delete(o),le.every(a=>i[a].size===0)&&(Reflect.defineProperty(e,t,{value:i.o,writable:!0,configurable:!0})||(e[t]=i.o),delete r[t]),Object.keys(r).length==0&&S.delete(e),!0):!1}function Ge(){for(let[e,t]of S.entries())for(let o in t)for(let n of le)for(let r of t[o]?.[n].keys()??[])de(e,o,r,n)}var z=e=>(t,o,n,r=!1)=>{if(typeof o[t]!="function")throw new Error(`${t} is not a function in ${o.constructor.name}`);S.has(o)||S.set(o,{});let i=S.get(o);if(!i[t]){let p=o[t];i[t]={o:p,b:new Map,i:new Map,a:new Map};let b=(v,A,U)=>{let pt=je(t,o,A,v,U);return r&&c(),pt},D=new Proxy(p,{apply:(v,A,U)=>b(A,U,!1),construct:(v,A)=>b(p,A,!0),get:(v,A,U)=>A=="toString"?p.toString.bind(p):Reflect.get(v,A,U)});Reflect.defineProperty(o,t,{value:D,configurable:!0,writable:!0})||(o[t]=D)}let a=Symbol(),c=()=>de(o,t,a,e);return i[t][e].set(a,n),c};var ft=z("b"),ut=z("i"),x=z("a");var He={...pe};var he={};C(he,{filterModules:()=>fe,find:()=>k,findAll:()=>ge,findByDisplayName:()=>B,findByDisplayNameAll:()=>ht,findByProps:()=>l,findByPropsAll:()=>gt,findByStoreName:()=>X,modules:()=>ue});function Je(e){Object.defineProperty(window.modules,e,{value:window.modules[e],enumerable:!1,configurable:!0,writable:!0})}for(let e in window.modules){let t=Number(e),o=window.modules[t].publicModule.exports;if(!o||o===window||o.proxygone===null){Je(t);continue}}var Ye=e=>Object.values(window.modules).find(t=>t.publicModule.exports?.[e]).publicModule.exports;window.React=Ye("createElement");var me=Ye("isMoment"),fe=(e,t=!1)=>o=>{let n=[],r=me?.locale();for(let i in e){let a=Number(i),c=e[a].publicModule.exports;if(!e[a].isInitialized)try{__r(a),r&&r!==me.locale()&&me.locale(r)}catch{}if(!c){Je(a);continue}try{if(c.default&&c.__esModule&&o(c.default)){if(t)return c.default;n.push(c.default)}if(o(c)){if(t)return c;n.push(c)}}catch(p){console.error(`Failed to getModule... ${p.stack||p.toString()}`)}}if(!t)return n},ue=window.modules,k=fe(ue,!0),ge=fe(ue),We=e=>t=>e.every(o=>t[o]!==void 0),Ke=(e,t)=>t?o=>o.name===e:o=>o?.default?.name===e,l=(...e)=>k(We(e)),gt=(...e)=>ge(We(e)),B=(e,t=!0)=>k(Ke(e,t)),ht=(e,t=!0)=>ge(Ke(e,t)),X=e=>k(t=>t.getName?.()===e);var yt=l("setLogFn").default,bt=new yt("Vendetta"),h=bt;var we={};C(we,{AsyncStorage:()=>j,Flux:()=>St,FluxDispatcher:()=>Z,NavigationNative:()=>xe,React:()=>xt,ReactNative:()=>d,assets:()=>$,channels:()=>vt,clipboard:()=>ve,constants:()=>ye,i18n:()=>Q,navigation:()=>N,navigationStack:()=>Se,stylesheet:()=>m,toasts:()=>be,url:()=>q});var ye=l("API_HOST"),vt=l("getVoiceChannelId"),Q=l("Messages"),q=l("openURL"),be=k(e=>e.open&&e.close&&!e.startDrag&&!e.init&&!e.openReplay&&!e.setAlwaysOnTop),m=l("createThemedStyleSheet"),ve=l("setString","getString"),$=l("registerAsset"),N=l("pushLazy"),Se=l("createStackNavigator"),xe=l("NavigationContainer"),St=l("connectStores"),Z=l("_currentDispatchActionType"),xt=l("createElement"),d=l("Text","Image"),j=l("setItem");function R(e){try{ve.setString(e)}catch{throw new Error("Failed to set clipboard content.")}}function G(e,t,{walkable:o=[],ignore:n=[],maxDepth:r=100}={}){let i=0;function a(c,p,{walkable:b=[],ignore:D=[]}={}){if(i+=1,!(i>r)){if(typeof p=="string"){if(c.hasOwnProperty(p))return c[p]}else if(p(c))return c;if(c){if(Array.isArray(c))for(let O of c){let v=a(O,p,{walkable:b,ignore:D});if(v)return v}else if(typeof c=="object"){for(let O of Object.keys(c))if(!(b!=null&&b.includes(O))&&!D.includes(O))try{let v=a(c[O],p,{walkable:b,ignore:D});if(v)return v}catch{}}}}}return a(e,t,{walkable:o,ignore:n})}var ee=(e,t)=>G(e,t,{walkable:["props","children","child","sibling"]});var Ie={};C(Ie,{DISCORD_SERVER:()=>Te,GITHUB:()=>Re});var Te="https://discord.gg/n9QQ4XhhJP",Re="https://github.com/vendetta-mod";var _e={};C(_e,{Forms:()=>f,General:()=>H,Search:()=>Pe});var f=l("Form","FormSection"),H=l("Button","Text","View"),Pe=B("StaticSearchBarContainer");var De={};C(De,{showToast:()=>u});function u(e,t){return be.open({content:e,source:t})}var w={};function ze(){try{x("registerAsset",$,(e,t)=>{let o=e[0];w[o.name]={...o,id:t}});for(let e=1;;e++){let t=$.getAssetByID(e);if(!t)break;w[t.name]||(w[t.name]={...t,id:e})}}catch{}}var Xe=e=>Object.values(w).find(e),Qe=e=>w[e],qe=e=>$.getAssetByID(e),s=e=>w[e]?.id;function V(e,t){let o={},n={get(r,i){let a=Reflect.get(r,i);return typeof a=="object"&&a!==null?new Proxy(a,n):a},set(r,i,a){return Reflect.set(r,i,a),j.setItem(e,JSON.stringify(o)),!0},deleteProperty(r,i){return Reflect.deleteProperty(r,i),j.setItem(e,JSON.stringify(o)),!0}};return j.getItem(e).then(async function(r){if(!r)return;let i=JSON.parse(r);if(t&&typeof t=="function")t(i);else for(let a of Object.keys(i))o[a]=i[a]}),new Proxy(o,n)}var T=V("VENDETTA_SETTINGS");var{FormRow:I,FormSection:wt,FormDivider:Ze}=f;function Ae({navigation:e}){return React.createElement(wt,{key:"Vendetta",title:"Vendetta"},React.createElement(I,{label:"General",leading:React.createElement(I.Icon,{source:s("settings")}),trailing:I.Arrow,onPress:()=>e.push("VendettaSettings")}),React.createElement(Ze,null),React.createElement(I,{label:"Plugins",leading:React.createElement(I.Icon,{source:s("debug")}),trailing:I.Arrow,onPress:()=>e.push("VendettaPlugins")}),T.developerSettings&&React.createElement(React.Fragment,null,React.createElement(Ze,null),React.createElement(I,{label:"Developer",leading:React.createElement(I.Icon,{source:s("ic_progress_wrench_24px")}),trailing:I.Arrow,onPress:()=>e.push("VendettaDeveloper")})))}var P;function te(e){if(P!==void 0&&P.readyState!==WebSocket.CLOSED&&P.close(),e===""){u("Invalid debugger URL!",s("Small"));return}P=new WebSocket(`ws://${e}`),P.addEventListener("open",()=>u("Connected to debugger.",s("Check"))),P.addEventListener("message",t=>{try{(0,eval)(t.data)}catch(o){console.error(o)}}),P.addEventListener("error",t=>{console.log(`Debugger error: ${t.message}`),u("An error occurred with the debugger connection!",s("Small"))})}function et(){x("nativeLoggingHook",globalThis,(e,t)=>{P?.readyState===WebSocket.OPEN&&P.send(JSON.stringify({message:e[0],level:e[1]})),h.log(e[0])})}var Ne="66e84ec";function tt(){let e=d.NativeModules.InfoDictionaryManager,t=window.HermesInternal.getRuntimeProperties(),o=d.Platform.constants,n=o.reactNativeVersion,r=d.NativeModules.DCDDeviceManager;return{vendetta:{version:Ne},discord:{version:e.Version,build:e.Build},react:{version:React.version,nativeVersion:`${n.major||0}.${n.minor||0}.${n.patch||0}`},hermes:{version:t["OSS Release Version"],buildType:t.Build,bytecodeVersion:t["Bytecode Version"]},...d.Platform.select({android:{os:{name:"Android",version:o.Release,sdk:o.Version}},ios:{os:{name:o.systemName,version:o.osVersion}}}),...d.Platform.select({android:{device:{manufacturer:o.Manufacturer,brand:o.Brand,model:o.Model,codename:r.device}},ios:{device:{manufacturer:r.deviceManufacturer,brand:r.deviceBrand,model:r.deviceModel,codename:r.device}}})}}var{FormRow:ot,FormText:Tt}=f;function oe({label:e,version:t,icon:o}){return React.createElement(ot,{label:e,leading:React.createElement(ot.Icon,{source:s(o)}),trailing:React.createElement(Tt,null,t),onPress:()=>{R(`${e} - ${t}`),u("Copied version to clipboard.",s("toast_copy_link"))}})}var{FormRow:_,FormSwitchRow:Rt,FormSection:re,FormDivider:ne}=f,g=tt();function Fe(){let[e,t]=React.useState(T.developerSettings||!1),o=[{label:"Vendetta",version:g.vendetta.version,icon:"ic_progress_wrench_24px"},{label:"Discord",version:`${g.discord.version} (${g.discord.build})`,icon:"Discord"},{label:"React",version:g.react.version,icon:"ic_category_16px"},{label:"React Native",version:g.react.nativeVersion,icon:"mobile"},{label:"Hermes",version:`${g.hermes.version} ${g.hermes.buildType} (Bytecode ${g.hermes.bytecodeVersion})`,icon:"ic_server_security_24px"}],n=[{label:"Operating System",version:`${g.os.name} ${g.os.version}`,icon:"ic_cog_24px"},...g.os.sdk?[{label:"SDK",version:g.os.sdk,icon:"ic_profile_badge_verified_developer_color"}]:[],{label:"Manufacturer",version:g.device.manufacturer,icon:"ic_hammer_and_chisel_24px"},{label:"Brand",version:g.device.brand,icon:"ic_settings_boost_24px"},{label:"Model",version:g.device.model,icon:"ic_phonelink_24px"},{label:d.Platform.select({android:"Codename",ios:"Machine ID"}),version:g.device.codename,icon:"ic_compose_24px"}];return React.createElement(d.ScrollView,null,React.createElement(re,{title:"Links"},React.createElement(_,{label:"Discord Server",leading:React.createElement(_.Icon,{source:s("Discord")}),trailing:_.Arrow,onPress:()=>q.openURL(Te)}),React.createElement(ne,null),React.createElement(_,{label:"GitHub",leading:React.createElement(_.Icon,{source:s("img_account_sync_github_white")}),trailing:_.Arrow,onPress:()=>q.openURL(Re)})),React.createElement(re,{title:"Versions"},o.map(r=>React.createElement(React.Fragment,null,React.createElement(oe,{label:r.label,version:r.version,icon:r.icon}),React.createElement(ne,null)))),React.createElement(re,{title:"Platform Info"},n.map(r=>React.createElement(React.Fragment,null,React.createElement(oe,{label:r.label,version:r.version,icon:r.icon}),React.createElement(ne,null)))),React.createElement(re,{title:"Actions"},React.createElement(_,{label:"Reload Discord",leading:React.createElement(_.Icon,{source:s("ic_message_retry")}),onPress:()=>d.NativeModules.BundleUpdaterManager.reload()}),React.createElement(ne,null),React.createElement(Rt,{label:"Developer Settings",leading:React.createElement(_.Icon,{source:s("ic_progress_wrench_24px")}),value:e,onValueChange:r=>{T.developerSettings=r,t(r)}})))}var L=m.createThemedStyleSheet({container:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},card:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:m.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:m.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:m.ThemeColorMap.HEADER_PRIMARY},headerTitle:{fontFamily:ye.Fonts.PRIMARY_BOLD,color:m.ThemeColorMap.HEADER_PRIMARY},backIcon:{tintColor:m.ThemeColorMap.INTERACTIVE_ACTIVE,marginLeft:15,marginRight:20}}),rt=Se.createStackNavigator(),{TouchableOpacity:It,Image:Pt}=H;function J({name:e,children:t}){return React.createElement(xe.NavigationContainer,{independent:!0},React.createElement(rt.Navigator,{initialRouteName:e,style:L.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:L.card,headerStyle:L.header,headerTitleContainerStyle:L.headerTitleContainer}},React.createElement(rt.Screen,{name:e,component:t,options:{headerTitleStyle:L.headerTitle,headerLeft:()=>React.createElement(It,{onPress:()=>N.pop()},React.createElement(Pt,{style:L.backIcon,source:s("back-icon")}))}})))}var y=V("VENDETTA_PLUGINS",async function(e){for(let t of Object.keys(e)){let o=e[t];e[t].update?await Y(o.id):y[t]=e[t],e[t].enabled&&y[t]&&Me(t)}}),F={};async function Y(e){if(e.endsWith("/")||(e+="/"),typeof e!="string"||e in y)throw new Error("Plugin ID invalid or taken");let t;try{t=await(await fetch(new URL("manifest.json",e),{cache:"no-store"})).json()}catch{throw new Error(`Failed to fetch manifest for ${e}`)}let o;try{o=await(await fetch(new URL(t.main||"index.js",e),{cache:"no-store"})).text()}catch{throw new Error(`Failed to fetch JS for ${e}`)}if(o.length===0)throw new Error(`Failed to fetch JS for ${e}`);y[e]={id:e,manifest:t,enabled:!1,update:!0,js:o}}function Ee(e){let t={...window.vendetta,plugin:{manifest:e.manifest,storage:V(e.id),showSettings:()=>Oe(e)}},o=`vendetta=>{return ${e.js}}
//# sourceURL=${e.id}`,n=(0,eval)(o)(t),r=typeof n=="function"?n():n;return r.default||r}function Me(e){let t=y[e];if(!t)throw new Error("Attempted to start non-existent plugin");try{let o=Ee(t);F[e]=o,o.onLoad?.(),t.enabled=!0}catch(o){h.error(`Plugin ${t.id} errored whilst loading, and will be unloaded`,o);try{F[t.id]?.onUnload?.()}catch(n){h.error(`Plugin ${t.id} errored whilst unloading`,n)}delete F[e],t.enabled=!1}}function W(e){let t=y[e],o=F[e];if(!t)throw new Error("Attempted to stop non-existent plugin");if(!o)throw new Error("Attempted to stop a non-started plugin");try{F[t.id]?.onUnload?.()}catch(n){h.error(`Plugin ${t.id} errored whilst unloading`,n)}delete F[e],t.enabled=!1}function ie(e){y[e].enabled&&W(e),delete y[e]}var K=e=>F[e]?.settings;function Oe(e){let t=K(e.id);if(!t)return h.error(`Plugin ${e.id} is not loaded or has no settings`);N.push(J,{name:e.manifest.name,children:t})}var{FormRow:Ce,FormSwitch:_t}=f,{TouchableOpacity:se,Image:ae}=H,E=m.createThemedStyleSheet({card:{backgroundColor:m.ThemeColorMap.BACKGROUND_SECONDARY,borderRadius:5,margin:10,marginTop:0},header:{backgroundColor:m.ThemeColorMap.BACKGROUND_TERTIARY,borderTopLeftRadius:5,borderTopRightRadius:5},actions:{justifyContent:"flex-end",flexDirection:"row-reverse",alignItems:"center"},icon:{width:22,height:22,marginLeft:5,tintColor:m.ThemeColorMap.INTERACTIVE_NORMAL}});function ke({plugin:e}){let[t,o]=React.useState(e.enabled),[n,r]=React.useState(e.update),[i,a]=React.useState(!1);return i?React.createElement(React.Fragment,null):React.createElement(d.View,{style:E.card},React.createElement(Ce,{style:E.header,label:`${e.manifest.name} by ${e.manifest.authors.map(c=>c.name).join(", ")}`,leading:React.createElement(Ce.Icon,{source:s(e.manifest.vendetta.icon||"ic_application_command_24px")}),trailing:React.createElement(_t,{value:e.enabled,onValueChange:c=>{c?Me(e.id):W(e.id),o(c)}})}),React.createElement(Ce,{label:e.manifest.description,trailing:React.createElement(d.View,{style:E.actions},React.createElement(se,{onPress:()=>{ie(e.id),a(!0)}},React.createElement(ae,{style:E.icon,source:s("ic_message_delete")})),React.createElement(se,{onPress:()=>{R(e.id),u("Copied plugin URL to clipboard.",s("toast_copy_link"))}},React.createElement(ae,{style:E.icon,source:s("copy")})),React.createElement(se,{onPress:()=>{e.update=!e.update,u(`${e.update?"Enabled":"Disabled"} updates for ${e.manifest.name}.`,s("toast_image_saved")),r(e.update)}},React.createElement(ae,{style:E.icon,source:s(e.update?"Check":"Small")})),K(e.id)&&React.createElement(se,{onPress:()=>Oe(e)},React.createElement(ae,{style:E.icon,source:s("settings")})))}))}var{FormInput:Dt,FormRow:nt}=f;function Be(){let[e,t]=React.useState(""),[o,n]=React.useState(y);return React.createElement(d.View,{style:{flex:1}},React.createElement(Dt,{value:e,onChange:r=>t(r),title:"PLUGIN URL"}),React.createElement(nt,{label:"Install plugin",leading:React.createElement(nt.Icon,{source:s("ic_add_perk_24px")}),onPress:()=>{Y(e).then(()=>{t(""),n(y)}).catch(r=>{u(r.message,s("Small"))})}}),React.createElement(d.FlatList,{style:{marginTop:10},data:Object.values(o),renderItem:({item:r})=>React.createElement(ke,{plugin:r}),keyExtractor:r=>r.id}))}var{FormRow:At}=f,Nt=m.createThemedStyleSheet({asset:{width:32,height:32}});function Ve({asset:e}){return React.createElement(At,{label:`${e.name} - ${e.id}`,trailing:React.createElement(d.Image,{source:e.id,style:Nt.asset}),onPress:()=>{R(e.name),u("Copied asset name to clipboard.",s("toast_copy_link"))}})}var{FormDivider:Ft}=f,Et=m.createThemedStyleSheet({search:{margin:0,padding:15,borderBottomWidth:0,background:"none",backgroundColor:"none"}});function Le(){let[e,t]=React.useState("");return React.createElement(d.View,{style:{flex:1}},React.createElement(Pe,{style:Et.search,onChangeText:o=>t(o),placeholder:"Search..."}),React.createElement(d.FlatList,{data:Object.values(w).filter(o=>o.name.includes(e)),renderItem:({item:o})=>React.createElement(React.Fragment,null,React.createElement(Ve,{asset:o}),React.createElement(Ft,null)),keyExtractor:o=>o.name}))}var{FormSection:it,FormRow:M,FormInput:Mt,FormDivider:st}=f;function Ue(){let[e,t]=React.useState(T.debuggerUrl||"");return React.createElement(d.View,{style:{flex:1}},React.createElement(it,{title:"Debug"},React.createElement(Mt,{value:e,onChange:o=>{T.debuggerUrl=o,t(o)},title:"DEBUGGER URL"}),React.createElement(st,null),React.createElement(M,{label:"Connect to debug websocket",leading:()=>React.createElement(M.Icon,{source:s("copy")}),onPress:()=>te(e)}),React.createElement(st,null),window.__vendetta_rdc&&React.createElement(M,{label:"Connect to React DevTools",leading:()=>React.createElement(M.Icon,{source:s("ic_badge_staff")}),onPress:()=>{try{window.__vendetta_rdc?.connectToDevTools({host:e.split(":")[0],resolveRNStyle:d.StyleSheet.flatten})}catch(o){h.error("Failed to connect to React DevTools!",o),u("Failed to connect to React DevTools!",s("Small"))}}})),React.createElement(it,{title:"Other"},React.createElement(M,{label:"Asset Browser",leading:()=>React.createElement(M.Icon,{source:s("ic_media_upload")}),trailing:M.Arrow,onPress:()=>N.push(J,{name:"Asset Browser",children:Le})})))}var Ot=B("getScreens",!1),Ct=B("UserSettingsOverviewWrapper",!1),ce=[];function $e(){x("default",Ot,(e,t)=>({...t,VendettaSettings:{title:"Vendetta",render:Fe},VendettaPlugins:{title:"Plugins",render:Be},VendettaDeveloper:{title:"Developer",render:Ue}})),x("default",Ct,(e,t)=>{for(let n of ce)n();ce=[];let o=ee(t.props.children,n=>n.type&&n.type.name==="UserSettingsOverview");ce.push(x("renderSupportAndAcknowledgements",o.type.prototype,(n,{props:{children:r}})=>{let i=r.findIndex(a=>a?.type?.name==="UploadLogsButton");i!==-1&&r.splice(i,1)})),ce.push(x("render",o.type.prototype,(n,{props:{children:r}})=>{let i=[Q.Messages.BILLING_SETTINGS,Q.Messages.PREMIUM_SETTINGS],a=r.findIndex(c=>i.includes(c.props.title));r.splice(a===-1?4:a,0,React.createElement(Ae,{navigation:o.props.navigation}))}))})}var kt=l("updateTheme","overrideTheme"),at=l("setAMOLEDThemeEnabled"),ct=X("ThemeStore"),Bt=X("UnsyncedUserSettingsStore");function lt(){let e=ct.theme||"dark";kt.overrideTheme(e),at&&Bt.useAMOLEDTheme===2&&at.setAMOLEDThemeEnabled(!0),Z.unsubscribe("I18N_LOAD_START",lt)}function dt(){try{ct&&Z.subscribe("I18N_LOAD_START",lt)}catch(e){h.error("Failed to fix theme...",e)}}console.log("Hello from Vendetta!");async function Vt(){let e=!1;try{window.vendetta={patcher:He,metro:{...he,common:{...we}},constants:{...Ie},utils:{copyText:R,findInReactTree:ee,findInTree:G},debug:{connectToDebugger:te},ui:{components:{..._e},toasts:{...De},assets:{all:w,find:Xe,getAssetByID:qe,getAssetByName:Qe,getAssetIDByName:s}},plugins:{plugins:y,fetchPlugin:Y,evalPlugin:Ee,stopPlugin:W,removePlugin:ie,getSettings:K},settings:T,logger:h,version:Ne},et(),ze(),dt(),$e()}catch(t){e=!0,alert(`Vendetta failed to initialize... ${t.stack||t.toString()}`)}e||h.log("Vendetta is ready!")}Vt();})();
//# sourceURL=Vendetta