"use strict";(()=>{var Xe=Object.defineProperty;var D=(e,t)=>{for(var o in t)Xe(e,o,{get:t[o],enumerable:!0})};var K={};D(K,{after:()=>w,before:()=>Qe,instead:()=>qe,unpatchAll:()=>Ce});var Y=["a","b","i"],S=new Map;function Oe(e,t,o,r,n){let l=S.get(t)?.[e];if(!l)return n?Reflect.construct(t[e],o,r):t[e].apply(r,o);for(let a of l.b.values()){let y=a.call(r,o);Array.isArray(y)&&(o=y)}let c=(...a)=>n?Reflect.construct(l.o,a,r):l.o.apply(r,a);for(let a of l.i.values()){let y=c;c=(...v)=>a.call(r,v,y)}let s=c(...o);for(let a of l.a.values())s=a.call(r,o,s)??s;return s}function W(e,t,o,r){let n=S.get(e),l=n?.[t];return l?.[r].has(o)?(l[r].delete(o),Y.every(c=>l[c].size===0)&&(Reflect.defineProperty(e,t,{value:l.o,writable:!0,configurable:!0})||(e[t]=l.o),delete n[t]),Object.keys(n).length==0&&S.delete(e),!0):!1}function Ce(){for(let[e,t]of S.entries())for(let o in t)for(let r of Y)for(let n of t[o]?.[r].keys()??[])W(e,o,n,r)}var j=e=>(t,o,r,n=!1)=>{if(typeof o[t]!="function")throw new Error(`${t} is not a function in ${o.constructor.name}`);S.has(o)||S.set(o,{});let l=S.get(o);if(!l[t]){let a=o[t];l[t]={o:a,b:new Map,i:new Map,a:new Map};let y=(b,A,C)=>{let ze=Oe(t,o,A,b,C);return n&&s(),ze},v=new Proxy(a,{apply:(b,A,C)=>y(A,C,!1),construct:(b,A)=>y(a,A,!0),get:(b,A,C)=>A=="toString"?a.toString.bind(a):Reflect.get(b,A,C)});Reflect.defineProperty(o,t,{value:v,configurable:!0,writable:!0})||(o[t]=v)}let c=Symbol(),s=()=>W(o,t,c,e);return l[t][e].set(c,r),s};var Qe=j("b"),qe=j("i"),w=j("a");var _e={...K};var Z={};D(Z,{filterModules:()=>X,find:()=>_,findAll:()=>q,findByDisplayName:()=>$,findByDisplayNameAll:()=>et,findByProps:()=>p,findByPropsAll:()=>Ze,modules:()=>Q});function Be(e){Object.defineProperty(window.modules,e,{value:window.modules[e],enumerable:!1,configurable:!0,writable:!0})}for(let e in window.modules){let t=Number(e),o=window.modules[t].publicModule.exports;if(!o||o===window||o.proxygone===null){Be(t);continue}}var ke=e=>Object.values(window.modules).find(t=>t.publicModule.exports?.[e]).publicModule.exports;window.React=ke("createElement");var z=ke("isMoment"),X=(e,t=!1)=>o=>{let r=[],n=z?.locale();for(let l in e){let c=Number(l),s=e[c].publicModule.exports;if(!e[c].isInitialized)try{__r(c),n&&n!==z.locale()&&z.locale(n)}catch{}if(!s){Be(c);continue}try{if(s.default&&s.__esModule&&o(s.default)){if(t)return s.default;r.push(s.default)}if(o(s)){if(t)return s;r.push(s)}}catch(a){console.error(`Failed to getModule... ${a.stack||a.toString()}`)}}if(!t)return r},Q=window.modules,_=X(Q,!0),q=X(Q),Me=e=>t=>e.every(o=>t[o]!==void 0),Le=(e,t)=>t?o=>o.name===e:o=>o?.default?.name===e,p=(...e)=>_(Me(e)),Ze=(...e)=>q(Me(e)),$=(e,t=!0)=>_(Le(e,t)),et=(e,t=!0)=>q(Le(e,t));var tt=p("setLogFn").default,ot=new tt("Vendetta"),R=ot;var se={};D(se,{AsyncStorage:()=>M,NavigationNative:()=>ne,React:()=>nt,ReactNative:()=>m,assets:()=>B,channels:()=>rt,clipboard:()=>oe,constants:()=>ee,i18n:()=>G,navigation:()=>k,navigationStack:()=>re,stylesheet:()=>d,toasts:()=>te,url:()=>H});var ee=p("API_HOST"),rt=p("getVoiceChannelId"),G=p("Messages"),H=p("openURL"),te=_(e=>e.open&&e.close&&!e.startDrag&&!e.init&&!e.openReplay&&!e.setAlwaysOnTop),d=p("createThemedStyleSheet"),oe=p("setString","getString"),B=p("registerAsset"),k=p("pushLazy"),re=p("createStackNavigator"),ne=p("NavigationContainer"),nt=p("createElement"),m=p("Text","Image"),M=p("setItem");function T(e){try{oe.setString(e)}catch{throw new Error("Failed to set clipboard content.")}}function L(e,t,{walkable:o=[],ignore:r=[],maxDepth:n=100}={}){let l=0;function c(s,a,{walkable:y=[],ignore:v=[]}={}){if(l+=1,!(l>n)){if(typeof a=="string"){if(s.hasOwnProperty(a))return s[a]}else if(a(s))return s;if(!!s){if(Array.isArray(s))for(let E of s){let b=c(E,a,{walkable:y,ignore:v});if(b)return b}else if(typeof s=="object"){for(let E of Object.keys(s))if(!(y!=null&&y.includes(E))&&!v.includes(E))try{let b=c(s[E],a,{walkable:y,ignore:v});if(b)return b}catch{}}}}}return c(e,t,{walkable:o,ignore:r})}function V(e,t){return L(e,t,{walkable:["props","children","child","sibling"]})}var le={};D(le,{DISCORD_SERVER:()=>ie,GITHUB:()=>ae});var ie="https://discord.gg/n9QQ4XhhJP",ae="https://github.com/vendetta-mod";var ce={};D(ce,{Forms:()=>u,General:()=>U});var u=p("Form","FormSection"),U=p("Button","Text","View");var pe={};D(pe,{showToast:()=>f});function f(e,t){return te.open({content:e,source:t})}var x={};function de(){try{w("registerAsset",B,(e,t)=>{let o=e[0];x[o.name]={...o,id:t}});for(let e=1;;e++){let t=B.getAssetByID(e);if(!t)break;x[t.name]||(x[t.name]={...t,id:e})}}catch{}}var Ve=e=>Object.values(x).find(e),Ue=e=>x[e],je=e=>B.getAssetByID(e),i=e=>x[e]?.id;var{FormRow:I,FormSection:st}=u;function me({navigation:e}){return React.createElement(st,{key:"Vendetta",title:"Vendetta"},React.createElement(I,{label:"General",leading:()=>React.createElement(I.Icon,{source:i("settings")}),trailing:I.Arrow,onPress:()=>e.push("VendettaSettings")}),React.createElement(I,{label:"Plugins",leading:()=>React.createElement(I.Icon,{source:i("debug")}),trailing:I.Arrow,onPress:()=>e.push("VendettaPlugins")}),React.createElement(I,{label:"Asset Browser",leading:()=>React.createElement(I.Icon,{source:i("grid")}),trailing:I.Arrow,onPress:()=>e.push("VendettaAssetBrowser")}))}var P,it=eval;function J(e){if(P!==void 0&&P.readyState!==WebSocket.CLOSED&&P.close(),e===""){f("Invalid debugger URL!",i("Small"));return}P=new WebSocket(`ws://${e}`),P.addEventListener("open",()=>f("Connected to debugger.",i("Check"))),P.addEventListener("message",t=>{try{it(t.data)}catch(o){console.error(o)}}),P.addEventListener("error",t=>{console.log(`Debugger error: ${t.message}`),f("An error occurred with the debugger connection!",i("Small"))})}function $e(){w("nativeLoggingHook",globalThis,(e,t)=>{P?.readyState===WebSocket.OPEN&&P.send(JSON.stringify({message:e[0],level:e[1]})),R.log(e[0])})}var{FormRow:Ge,FormText:at}=u;function ue({label:e,version:t,icon:o}){return React.createElement(Ge,{label:e,leading:()=>React.createElement(Ge.Icon,{source:i(o)}),trailing:()=>React.createElement(at,null,t),onPress:()=>{T(`${e} - ${t}`),f("Copied version to clipboard.",i("toast_copy_link"))}})}var{FormRow:h,FormSection:fe,FormInput:lt}=u,ge=window.HermesInternal.getRuntimeProperties(),ye=m.Platform.constants.reactNativeVersion;function he(){let[e,t]=React.useState(""),o=[{label:"Discord",version:m.NativeModules.InfoDictionaryManager.Version,icon:"Discord"},{label:"React",version:React.version,icon:"ic_category_16px"},{label:"React Native",version:`${ye.major||0}.${ye.minor||0}.${ye.patch||0}`,icon:"mobile"},{label:"Hermes",version:`${ge["OSS Release Version"]} ${ge.Build} | Bytecode ${ge["Bytecode Version"]}`,icon:"ic_badge_staff"}];return React.createElement(m.ScrollView,null,React.createElement(fe,{title:"Links",android_noDivider:!0},React.createElement(h,{label:"Discord Server",leading:()=>React.createElement(h.Icon,{source:i("Discord")}),trailing:h.Arrow,onPress:()=>H.openURL(ie)}),React.createElement(h,{label:"GitHub",leading:()=>React.createElement(h.Icon,{source:i("img_account_sync_github_white")}),trailing:h.Arrow,onPress:()=>H.openURL(ae)})),React.createElement(fe,{title:"Debug"},React.createElement(lt,{value:e,onChange:r=>t(r),title:"DEBUGGER URL"}),React.createElement(h,{label:"Connect to debug websocket",leading:()=>React.createElement(h.Icon,{source:i("copy")}),trailing:h.Arrow,onPress:()=>J(e)}),React.createElement(h,{label:"Reload Discord",leading:()=>React.createElement(h.Icon,{source:i("ic_message_retry")}),trailing:h.Arrow,onPress:()=>m.NativeModules.BundleUpdaterManager.reload()})),React.createElement(fe,{title:"Versions"},o.map(r=>React.createElement(ue,{label:r.label,version:r.version,icon:r.icon}))))}var He={get(e,t){let o=Reflect.get(e,t);return typeof o=="object"&&o!==null?new Proxy(o,He):o},set(e,t,o){return Reflect.set(e,t,o),M.setItem("VENDETTA_PLUGINS",JSON.stringify(g)),!0},deleteProperty(e,t){return Reflect.deleteProperty(e,t),M.setItem("VENDETTA_PLUGINS",JSON.stringify(g)),!0}},g=new Proxy({},He),N={};async function be(e){if(e.endsWith("/")||(e+="/"),typeof e!="string"||e in g)throw new Error("Plugin ID invalid or taken");let t;try{t=await(await fetch(new URL("manifest.json",e),{cache:"no-store"})).json()}catch{throw new Error(`Failed to fetch manifest for ${e}`)}let o;try{o=await(await fetch(new URL(t.main||"index.js",e),{cache:"no-store"})).text()}catch{throw new Error(`Failed to fetch JS for ${e}`)}if(o.length===0)throw new Error(`Failed to fetch JS for ${e}`);g[e]={id:e,manifest:t,enabled:!1,update:!0,js:o}}function ct(e){let t=Object.assign({},window.vendetta),o=`vendetta=>{return ${e.js}}
//# sourceURL=${e.id}`,r=(0,eval)(o)(t),n=typeof r=="function"?r():r;return n.default||n}function Se(e){let t=g[e];if(!t)throw new Error("Attempted to start non-existent plugin");try{let o=ct(t);N[e]=o,o.onLoad?.(),t.enabled=!0}catch(o){R.error(`Plugin ${t.id} errored whilst loading, and will be unloaded`,o);try{N[t.id]?.onUnload?.()}catch(r){R.error(`Plugin ${t.id} errored whilst unloading`,r)}delete N[e],t.enabled=!1}}function we(e){let t=g[e],o=N[e];if(!t)throw new Error("Attempted to stop non-existent plugin");if(!o)throw new Error("Attempted to stop a non-started plugin");try{N[t.id]?.onUnload?.()}catch(r){R.error(`Plugin ${t.id} errored whilst unloading`,r)}delete N[e],t.enabled=!1}function Je(e){g[e].enabled&&we(e),delete g[e]}var Ye=e=>N[e]?.settings,We=()=>M.getItem("VENDETTA_PLUGINS").then(async function(e){if(!e)return;let t=JSON.parse(e);for(let o of Object.keys(t)){let r=t[o];t[o].update?await be(r.id):g[o]=t[o],t[o].enabled&&g[o]&&Se(o)}});var F=d.createThemedStyleSheet({container:{backgroundColor:d.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},card:{backgroundColor:d.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:d.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:d.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:d.ThemeColorMap.HEADER_PRIMARY},headerTitle:{fontFamily:ee.Fonts.PRIMARY_BOLD,color:d.ThemeColorMap.HEADER_PRIMARY},backIcon:{tintColor:d.ThemeColorMap.INTERACTIVE_ACTIVE,marginLeft:15,marginRight:20}}),Ke=re.createStackNavigator(),{TouchableOpacity:pt,Image:dt}=U;function xe({plugin:e,children:t}){return React.createElement(ne.NavigationContainer,null,React.createElement(Ke.Navigator,{initialRouteName:e.manifest.name,style:F.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:F.card,headerStyle:F.header,headerTitleContainerStyle:F.headerTitleContainer}},React.createElement(Ke.Screen,{name:e.manifest.name,component:t,options:{headerTitleStyle:F.headerTitle,headerLeft:()=>React.createElement(pt,{onPress:()=>k.pop()},React.createElement(dt,{style:F.backIcon,source:i("back-icon")}))}})))}var{FormRow:Re,FormSwitch:mt}=u,{TouchableOpacity:Ie,Image:Pe}=U,O=d.createThemedStyleSheet({card:{backgroundColor:d.ThemeColorMap.BACKGROUND_SECONDARY,borderRadius:5,margin:10},header:{backgroundColor:d.ThemeColorMap.BACKGROUND_TERTIARY,borderTopLeftRadius:5,borderTopRightRadius:5},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},icon:{width:22,height:22,marginLeft:5,tintColor:d.ThemeColorMap.INTERACTIVE_NORMAL}});function ve({plugin:e}){let[t,o]=React.useState(e.enabled),[r,n]=React.useState(e.update),[l,c]=React.useState(!1),s=Ye(e.id);return l?React.createElement(React.Fragment,null):React.createElement(m.View,{style:O.card},React.createElement(Re,{style:O.header,label:`${e.manifest.name} by ${e.manifest.authors.map(a=>a.name).join(", ")}`,leading:React.createElement(Re.Icon,{source:i(e.manifest.vendetta.icon||"ic_application_command_24px")}),trailing:React.createElement(mt,{value:e.enabled,onValueChange:a=>{a?Se(e.id):we(e.id),o(a)}})}),React.createElement(Re,{label:e.manifest.description,trailing:React.createElement(m.View,{style:O.actions},React.createElement(Ie,{onPress:()=>{Je(e.id),c(!0)}},React.createElement(Pe,{style:O.icon,source:i("ic_message_delete")})),React.createElement(Ie,{onPress:()=>{e.update=!e.update,n(e.update),f(`${e.update?"Enabled":"Disabled"} updates for ${e.manifest.name}.`,i("toast_image_saved"))}},React.createElement(Pe,{style:O.icon,source:i(e.update?"Check":"Small")})),s&&React.createElement(Ie,{onPress:()=>{k.push(xe,{plugin:e,children:s})}},React.createElement(Pe,{style:O.icon,source:i("settings")})))}))}var{FormInput:ut,FormRow:Ae}=u;function Te(){let[e,t]=React.useState(""),[o,r]=React.useState(g);return React.createElement(React.Fragment,null,React.createElement(ut,{value:e,onChange:n=>t(n),title:"PLUGIN URL"}),React.createElement(Ae,{label:"Install plugin",leading:()=>React.createElement(Ae.Icon,{source:i("add_white")}),trailing:Ae.Arrow,onPress:()=>{be(e).then(()=>{t(""),r(g)}).catch(n=>{f(n.message,i("Small"))})}}),React.createElement(m.FlatList,{data:Object.values(o),renderItem:({item:n})=>React.createElement(ve,{plugin:n}),keyExtractor:n=>n.id}))}var{FormRow:ft}=u,gt=d.createThemedStyleSheet({asset:{width:32,height:32}});function Ne({asset:e}){return React.createElement(ft,{label:`${e.name} - ${e.id}`,trailing:()=>React.createElement(m.Image,{source:e.id,style:gt.asset}),onPress:()=>{T(e.name),f("Copied asset name to clipboard.",i("toast_copy_link"))}})}var{FormInput:yt}=u;function Ee(){let[e,t]=React.useState("");return React.createElement(React.Fragment,null,React.createElement(yt,{value:e,onChange:o=>t(o),title:"SEARCH"}),React.createElement(m.FlatList,{data:Object.values(x).filter(o=>o.name.includes(e)),renderItem:({item:o})=>React.createElement(Ne,{asset:o}),keyExtractor:o=>o.name}))}var ht=$("getScreens",!1),bt=$("UserSettingsOverviewWrapper",!1),De=!1;function Fe(){w("default",ht,(e,t)=>({...t,VendettaSettings:{title:"Vendetta",render:he},VendettaPlugins:{title:"Plugins",render:Te},VendettaAssetBrowser:{title:"Asset Browser",render:Ee}})),w("default",bt,(e,t)=>{let o=V(t.props.children,r=>r.type&&r.type.name==="UserSettingsOverview");w("renderSupportAndAcknowledgements",o.type.prototype,(r,{props:{children:n}})=>{let l=n.findIndex(c=>c?.type?.name==="UploadLogsButton");l!==-1&&n.splice(l,1)}),w("render",o.type.prototype,(r,{props:{children:n}})=>{let l=[G.Messages.BILLING_SETTINGS,G.Messages.PREMIUM_SETTINGS],c=n.findIndex(s=>l.includes(s.props.title));n.splice(c===-1?4:c,De?1:0,React.createElement(me,{navigation:o.props.navigation})),De||(De=!0)})})}console.log("Hello from Vendetta!");async function St(){let e=!1;try{window.vendetta={patcher:_e,metro:{...Z,common:{...se}},constants:{...le},utils:{copyText:T,findInReactTree:V,findInTree:L},debug:{connectToDebugger:J},ui:{components:{...ce},toasts:{...pe},assets:{all:x,find:Ve,getAssetByID:je,getAssetByName:Ue,getAssetIDByName:i}},logger:R},Fe(),de(),$e(),We()}catch(t){e=!0,alert(`Vendetta failed to initialize... ${t.stack||t.toString()}`)}e||R.log("Vendetta is ready!")}St();})();
//# sourceURL=Vendetta